{"version":3,"file":"input-swipe.js","sourceRoot":"","sources":["../../../src/plugins/input-swipe.ts"],"names":[],"mappings":"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","sourcesContent":["import * as SpriteSpin from '../core'\n\n(() => {\n\nconst NAME = 'swipe'\n\ninterface SwipeState {\n  fling: number\n  snap: number\n}\n\nfunction getState(data) {\n  return SpriteSpin.getPluginState(data, NAME) as SwipeState\n}\nfunction getOption(data, name, fallback) {\n  return data[name] || fallback\n}\n\nfunction init(e, data) {\n  const state = getState(data)\n  state.fling = getOption(data, 'swipeFling', 10)\n  state.snap = getOption(data, 'swipeSnap', 0.50)\n}\n\nfunction start(e, data: SpriteSpin.Data) {\n  if (!data.loading && !SpriteSpin.is(data, 'dragging')) {\n    SpriteSpin.updateInput(e, data)\n    SpriteSpin.flag(data, 'dragging', true)\n  }\n}\n\nfunction update(e, data: SpriteSpin.Data) {\n  if (!SpriteSpin.is(data, 'dragging')) {\n    return\n  }\n  SpriteSpin.updateInput(e, data)\n  const frame = data.frame\n  const lane = data.lane\n  SpriteSpin.updateFrame(data, frame, lane)\n}\n\nfunction end(e, data: SpriteSpin.Data) {\n  if (!SpriteSpin.is(data, 'dragging')) {\n    return\n  }\n  SpriteSpin.flag(data, 'dragging', false)\n\n  const state = getState(data)\n  const input = SpriteSpin.getInputState(data)\n\n  let frame = data.frame\n  const lane = data.lane\n  const snap = state.snap\n  const fling = state.fling\n  let dS, dF\n  if (data.orientation === 'horizontal') {\n    dS = input.ndX\n    dF = input.ddX\n  } else {\n    dS = input.ndY\n    dF = input.ddY\n  }\n\n  if (dS >= snap || dF >= fling) {\n    frame = data.frame - 1\n  } else if (dS <= -snap || dF <= -fling) {\n    frame = data.frame + 1\n  }\n\n  SpriteSpin.resetInput(data)\n  SpriteSpin.updateFrame(data, frame, lane)\n  SpriteSpin.stopAnimation(data)\n}\n\nSpriteSpin.registerPlugin(NAME, {\n  name: NAME,\n  onLoad: init,\n  mousedown: start,\n  mousemove: update,\n  mouseup: end,\n  mouseleave: end,\n\n  touchstart: start,\n  touchmove: update,\n  touchend: end,\n  touchcancel: end\n})\n\n})()\n"]}