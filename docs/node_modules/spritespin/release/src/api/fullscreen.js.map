{"version":3,"file":"fullscreen.js","sourceRoot":"","sources":["../../../src/api/fullscreen.ts"],"names":[],"mappings":"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","sourcesContent":["import { boot, Data, extendApi, namespace, SizeMode } from '../core'\nimport { $ } from '../utils'\n\nexport interface Options {\n  source?: string | string[],\n  sizeMode?: SizeMode\n}\n\nfunction pick(target, names: string[]): string {\n  for (const name of names) {\n    if (target[name] || name in target) {\n      return name\n    }\n  }\n  return names[0]\n}\n\nconst browser = {\n  requestFullscreen: pick(document.documentElement, [\n    'requestFullscreen',\n    'webkitRequestFullScreen',\n        'mozRequestFullScreen',\n        'msRequestFullscreen']),\n  exitFullscreen: pick(document, [\n    'exitFullscreen',\n    'webkitExitFullscreen',\n    'webkitCancelFullScreen',\n        'mozCancelFullScreen',\n        'msExitFullscreen']),\n  fullscreenElement: pick(document, [\n    'fullscreenElement',\n    'webkitFullscreenElement',\n    'webkitCurrentFullScreenElement',\n        'mozFullScreenElement',\n        'msFullscreenElement']),\n  fullscreenEnabled: pick(document, [\n    'fullscreenEnabled',\n    'webkitFullscreenEnabled',\n        'mozFullScreenEnabled',\n        'msFullscreenEnabled']),\n  fullscreenchange: pick(document, [\n    'onfullscreenchange',\n    'onwebkitfullscreenchange',\n        'onmozfullscreenchange',\n        'onMSFullscreenChange']).replace(/^on/, ''),\n  fullscreenerror: pick(document, [\n    'onfullscreenerror',\n    'onwebkitfullscreenerror',\n        'onmozfullscreenerror',\n        'onMSFullscreenError']).replace(/^on/, '')\n}\n\nconst changeEvent = browser.fullscreenchange + '.' + namespace + '-fullscreen'\nfunction unbindChangeEvent() {\n  $(document).unbind(changeEvent)\n}\n\nfunction bindChangeEvent(callback) {\n  unbindChangeEvent()\n  $(document).bind(changeEvent, callback)\n}\n\nconst orientationEvent = 'orientationchange.' + namespace + '-fullscreen'\nfunction unbindOrientationEvent() {\n  $(window).unbind(orientationEvent)\n}\nfunction bindOrientationEvent(callback) {\n  unbindOrientationEvent()\n  $(window).bind(orientationEvent, callback)\n}\n\nfunction requestFullscreenNative(e) {\n  e = e || document.documentElement\n  e[browser.requestFullscreen]()\n}\n\nexport function exitFullscreen() {\n  return document[browser.exitFullscreen]()\n}\n\nexport function fullscreenEnabled() {\n  return document[browser.fullscreenEnabled]\n}\n\nexport function fullscreenElement() {\n  return document[browser.fullscreenElement]\n}\n\nexport function isFullscreen() {\n  return !!fullscreenElement()\n}\n\nexport function toggleFullscreen(data: Data, opts: Options) {\n  if (isFullscreen()) {\n    this.apiRequestFullscreen(opts)\n  } else {\n    this.exitFullscreen()\n  }\n}\n\nexport function requestFullscreen(data: Data, opts: Options) {\n  opts = opts || {}\n  const oWidth = data.width\n  const oHeight = data.height\n  const oSource = data.source\n  const oSize = data.sizeMode\n  const oResponsive = data.responsive\n  const enter = () => {\n    data.width = window.screen.width\n    data.height = window.screen.height\n    data.source = (opts.source || oSource) as string[]\n    data.sizeMode = opts.sizeMode || 'fit'\n    data.responsive = false\n    boot(data)\n  }\n  const exit = () => {\n    data.width = oWidth\n    data.height = oHeight\n    data.source = oSource\n    data.sizeMode = oSize\n    data.responsive = oResponsive\n    boot(data)\n  }\n\n  bindChangeEvent(() => {\n    if (isFullscreen()) {\n      enter()\n      bindOrientationEvent(enter)\n    } else {\n      unbindChangeEvent()\n      unbindOrientationEvent()\n      exit()\n    }\n  })\n  requestFullscreenNative(data.target[0])\n}\n\nextendApi({\n  fullscreenEnabled,\n  fullscreenElement,\n  exitFullscreen,\n  toggleFullscreen: function(opts: Options) {\n    toggleFullscreen(this.data, opts)\n  },\n  requestFullscreen: function(opts: Options) {\n    requestFullscreen(this.data, opts)\n  }\n})\n"]}