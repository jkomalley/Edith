{"version":3,"file":"render-zoom.js","sourceRoot":"","sources":["../../../src/plugins/render-zoom.ts"],"names":[],"mappings":"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","sourcesContent":["import * as SpriteSpin from '../core'\nimport * as Utils from '../utils'\n\n(() => {\n\nconst NAME = 'zoom'\n\ninterface ZoomState {\n  source: string[]\n  stage: any\n\n  oldX: number\n  oldY: number\n  currentX: number\n  currentY: number\n\n  clickTime: number\n  doubleClickTime: number\n  useWheel: boolean | number\n  useClick: number\n  pinFrame: boolean\n}\n\nfunction getState(data) {\n  return SpriteSpin.getPluginState(data, NAME) as ZoomState\n}\nfunction getOption(data, name, fallback) {\n  return name in data ? data[name] : fallback\n}\n\nfunction onInit(e, data: SpriteSpin.Data) {\n  const state = getState(data)\n  state.source = getOption(data, 'zoomSource', data.source)\n  state.useWheel = getOption(data, 'zoomUseWheel', false)\n  state.useClick = getOption(data, 'zoomUseClick', true)\n  state.pinFrame = getOption(data, 'zoomPinFrame', true)\n  state.doubleClickTime = getOption(data, 'zoomDoubleClickTime', 500)\n  state.stage = state.stage || Utils.$(\"<div class='zoom-stage'></div>\")\n  state.stage.css({\n    width    : '100%',\n    height   : '100%',\n    top      : 0,\n    left     : 0,\n    bottom   : 0,\n    right    : 0,\n    position : 'absolute'\n  })\n  .appendTo(data.target)\n  .hide()\n}\n\nfunction onDestroy(e, data: SpriteSpin.Data) {\n  const state = getState(data)\n  if (state.stage) {\n    state.stage.remove()\n    delete state.stage\n  }\n}\n\nfunction updateInput(e, data: SpriteSpin.Data) {\n  const state = getState(data)\n  if (!state.stage.is(':visible')) {\n    return\n  }\n\n  e.preventDefault()\n\n  if (state.pinFrame) {\n    // hack into drag/move module and disable dragging\n    // prevents frame change during zoom mode\n    SpriteSpin.flag(data, 'dragging', false)\n  }\n\n  // grab touch/cursor position\n  const cursor = Utils.getCursorPosition(e)\n  // normalize cursor position into [0:1] range\n  const x = cursor.x / data.width\n  const y = cursor.y / data.height\n\n  if (state.oldX == null) {\n    state.oldX = x\n    state.oldY = y\n  }\n  if (state.currentX == null) {\n    state.currentX = x\n    state.currentY = y\n  }\n\n  // calculate move delta since last frame and remember current position\n  let dx = x - state.oldX\n  let dy = y - state.oldY\n  state.oldX = x\n  state.oldY = y\n\n  // invert drag direction for touch events to enable 'natural' scrolling\n  if (e.type.match(/touch/)) {\n    dx = -dx\n    dy = -dy\n  }\n\n  // accumulate display coordinates\n  state.currentX = Utils.clamp(state.currentX + dx, 0, 1)\n  state.currentY = Utils.clamp(state.currentY + dy, 0, 1)\n\n  SpriteSpin.updateFrame(data, data.frame, data.lane)\n}\n\nfunction onClick(e, data: SpriteSpin.Data) {\n  const state = getState(data)\n  if (!state.useClick) {\n    return\n  }\n\n  e.preventDefault()\n  // simulate double click\n\n  const clickTime = new Date().getTime()\n  if (!state.clickTime) {\n    // on first click\n    state.clickTime = clickTime\n    return\n  }\n\n  // on second click\n  const timeDelta = clickTime - state.clickTime\n  if (timeDelta > state.doubleClickTime) {\n    // took too long, back to first click\n    state.clickTime = clickTime\n    return\n  }\n\n  // on valid double click\n  state.clickTime = undefined\n  if (toggleZoom(data)) {\n    updateInput(e, data)\n  }\n}\n\nfunction onMove(e, data: SpriteSpin.Data) {\n  const state = getState(data)\n  if (state.stage.is(':visible')) {\n    updateInput(e, data)\n  }\n}\n\nfunction onDraw(e, data: SpriteSpin.Data) {\n  const state = getState(data)\n\n  // calculate the frame index\n  const index = data.lane * data.frames + data.frame\n  // get the zoom image. Use original frames as fallback. This won't work for sprite sheets\n  const source = state.source[index]\n  const spec = Utils.findSpecs(data.metrics, data.frames, data.frame, data.lane)\n\n  // get display position\n  let x = state.currentX\n  let y = state.currentY\n  // fallback to centered position\n  if (x == null) {\n    x = state.currentX = 0.5\n    y = state.currentY = 0.5\n  }\n\n  if (source) {\n    // scale up from [0:1] to [0:100] range\n    x = Math.floor(x * 100)\n    y = Math.floor(y * 100)\n\n    // update background image and position\n    state.stage.css({\n      'background-repeat'   : 'no-repeat',\n      'background-image'    : `url('${source}')`,\n      'background-position' : `${x}% ${y}%`\n    })\n  } else if (spec.sheet && spec.sprite) {\n    const sprite = spec.sprite\n    const sheet = spec.sheet\n    const src = data.source[sheet.id]\n    const left = -Math.floor(sprite.sampledX + x * (sprite.sampledWidth - data.width))\n    const top = -Math.floor(sprite.sampledY + y * (sprite.sampledHeight - data.height))\n    const width = sheet.sampledWidth\n    const height = sheet.sampledHeight\n    state.stage.css({\n      'background-image'    : `url('${src}')`,\n      'background-position' : `${left}px ${top}px`,\n      'background-repeat'   : 'no-repeat',\n      // set custom background size to enable responsive rendering\n      '-webkit-background-size' : `${width}px ${height}px`, /* Safari 3-4 Chrome 1-3 */\n      '-moz-background-size'    : `${width}px ${height}px`, /* Firefox 3.6 */\n      '-o-background-size'      : `${width}px ${height}px`, /* Opera 9.5 */\n      'background-size'         : `${width}px ${height}px`  /* Chrome, Firefox 4+, IE 9+, Opera, Safari 5+ */\n    })\n  }\n}\n\nfunction toggleZoom(data) {\n  const state = getState(data)\n  if (!state.stage) {\n    throw new Error('zoom module is not initialized or is not available.')\n  }\n  if (state.stage.is(':visible')) {\n    showZoom(data)\n  } else {\n    hideZoom(data)\n    return true\n  }\n  return false\n}\n\nfunction showZoom(data) {\n  const state = getState(data)\n  state.stage.fadeOut()\n  data.stage.fadeIn()\n}\n\nfunction hideZoom(data) {\n  const state = getState(data)\n  state.stage.fadeIn()\n  data.stage.fadeOut()\n}\n\nfunction wheel(e: JQueryMouseEventObject, data: SpriteSpin.Data) {\n  const state = getState(data)\n  if (!data.loading && state.useWheel) {\n\n    const we = e.originalEvent as WheelEvent\n\n    let signY = we.deltaY === 0 ? 0 : we.deltaY > 0 ? 1 : -1\n    if (typeof state.useWheel === 'number') {\n      signY *= state.useWheel\n    }\n\n    if (state.stage.is(':visible') && signY > 0) {\n      e.preventDefault()\n      showZoom(data)\n    }\n    if (!state.stage.is(':visible') && signY < 0) {\n      e.preventDefault()\n      hideZoom(data)\n    }\n  }\n}\n\nSpriteSpin.registerPlugin(NAME, {\n  name: NAME,\n\n  mousedown: onClick,\n  touchstart: onClick,\n  mousemove: onMove,\n  touchmove: onMove,\n  wheel: wheel,\n\n  onInit: onInit,\n  onDestroy: onDestroy,\n  onDraw: onDraw\n})\n\nSpriteSpin.extendApi({\n  toggleZoom: function() { toggleZoom(this.data) } // tslint:disable-line\n})\n\n})()\n"]}